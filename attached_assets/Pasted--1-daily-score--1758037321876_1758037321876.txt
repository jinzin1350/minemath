سناریو:
یک بازی داریم با منطق روزانه. هر کاربر سه نوع امتیاز دارد:
1) daily_score = امتیاز روزانه‌ی امروز (تا ساعت 00:00 محلی قابل افزایش و سپس قفل/ریست می‌شود)
2) total_score = امتیاز کل تجمعیِ کاربر (هرگز ریست نمی‌شود و همواره جمع کل را نشان می‌دهد)
3) redeemable_points = امتیاز قابل‌دریافت/قابل‌تبدیل به جایزه (انباشت می‌شود تا زمانی که کاربر Redeem کند)

نیازمندی‌های دقیق:

A) ذخیره و افزایش امتیاز
- وقتی کاربر بازی را Stop می‌کند یا مرحله‌ای را تمام می‌کند:
  - اگر رکورد امروز Final نشده:
    - daily_score ← daily_score + new_points
    - total_score ← total_score + new_points
    - redeemable_points ← redeemable_points + new_points
  - اگر رکورد امروز وجود ندارد:
    - رکورد امروز را بساز و مقادیر بالا را اعمال کن.
  - اگر رکورد امروز Final شده:
    - هیچ افزایشی انجام نده و پیام مناسب برگردان.

B) پنجرهٔ روزانه و قفل شبانه
- تعریف روز بر اساس منطقهٔ زمانی قابل‌پیکربندی (پیش‌فرض America/Toronto).
- رأس ساعت 00:00 هر شب:
  - وضعیت روزِ گذشته را Final کن (daily_score همان مقدار نهاییِ روز قبل می‌ماند و در لیدربورد روزانه شمارش می‌شود).
  - daily_score نمایش‌داده‌شده برای «روز جدید» باید از صفر شروع شود (برای امروز = 0).
  - توجه: total_score و redeemable_points نباید ریست شوند.

C) نمایش در داشبورد
- Today’s Score: عدد daily_score امروز + وضعیت (Draft/Final).
- Total Score: عدد total_score (همیشه کل تجمعی تا این لحظه).
- Redeemable: عدد redeemable_points که هنوز خرج/redeem نشده و می‌تواند تبدیل به جایزه شود.
- اگر روز Final شده باشد، کنار Today’s Score برچسب «Final» نمایش داده شود و دکمه‌های ارتقا غیرفعال گردد.

D) لیدربورد
- Leaderboard Daily: بر اساس daily_score نهایی هر کاربر برای تاریخ مشخص (روز گذشته یا روز انتخاب‌شده).
- Leaderboard All-Time: بر اساس total_score.
- فیلتر تاریخ برای لیدربورد روزانه وجود داشته باشد (انتخاب روزهای قبل).

E) Redeem (دریافت جایزه)
- کاربر بتواند بخشی یا تمام redeemable_points را Redeem کند.
- هنگام Redeem:
  - اگر مقدار درخواست‌شده ≤ redeemable_points:
    - redeemable_points ← redeemable_points - requested_amount
    - یک تراکنش/رسید Redeem ثبت شود (برای ضدتقلب و پیگیری).
  - در غیر این صورت پیام خطای «کفایت امتیاز وجود ندارد» برگردان.
- Redeem هیچ اثری بر daily_score یا total_score ندارد؛ فقط از موجودی قابل‌دریافت کم می‌کند.